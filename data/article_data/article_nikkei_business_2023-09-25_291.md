###

第 2 回「最強のランサムウエア追跡チームは『はみ出し者』ばかり」から読む
ランサムウエアはデジタル時代にアップデートされた誘拐犯罪である。ハッカーはフィッシング（悪質なファイルが添付された電子メールを送信して相手をだます行為）などの手口を使ってコンピュータに侵入する。そしてひとたび侵入すると、ハッカーはランサムウエアを起動し、コンピュータを人質にして暗号資産を要求する。これはちょうど、誘拐犯が誰かを捕まえて、その解放と引き換えに金を要求するのと一緒だ。
このような犯罪は、古くは紀元前 75 年までにさかのぼることができる。海賊がジュリアス・シーザーを捕まえ、20 タラントを要求したのである。著述家のプルタルコスによれば、シーザーは自分の価値を低く評価されたと感じ、身代金を 50 タラントに引き上げるよう要求したという。しかし彼のように、身代金の支払いに応じる被害者はほとんどいない。
ランサムウエアのもうひとつの基本要素である暗号技術も、古代にまでさかのぼることができる。古代ローマ軍は、シーザーの名を冠した暗号を使用して、軍事に関するメッセージを暗号化していた。それからおよそ 2000 年後、ナチス・ドイツはエニグマと名づけられた装置で通信を暗号化し、第二次世界大戦で優位に立ったが、英国の数学者アラン・チューリング率いるチームが暗号の解読に成功すると、その優位も失われた。
最近では、暗号技術はインターネットの基幹技術として、デジタル銀行や電子商取引、デジタル通信の安全性を支えている。しかし残念なことに、政府、産業界、学界が開発した合法的な暗号ツールが、サイバー犯罪者にも利用されているのが現状だ。
ランサムウエアが革新的なのは、暗号化という行為そのものを武器に変えた点にある。ランサムウエアの登場前、ハッカーはコンピュータシステムに侵入しても、現金を得るまでには、まだしなければならないことが多く残されていた。盗んだ社会保障番号やクレジットカード番号の買い手を探さなければならず、それに伴うタイムラグや不確実性があった。
しかしランサムウエアは、被害者が自らのコンピュータに依存している状況を利用することで、ハッキングそのものを金を生み出す行為にしたのである。それは一度で完結する犯罪であり、コンセプトも実行も非常に単純であるため、恐喝しようとする者は誰でもダークウェブ（通常の検索エンジンからはアクセスできないアンダーグラウンドなオンライン・コンテンツ）に向かい、そこでランサムウエアのパッケージを購入できる。
2020 年 11 月下旬のある火曜日、マイケルはキャットルームで他の被害者からの嘆願への対応に追われ、マシューから送られてきたファイルに目を通すひまもないほどだった。しかしざっと見ただけで、彼はこの学校が、解読不能なランサムウエア「ウロボロス」（この名は古代エジプトに伝わる、自らの尾を食べる竜の像から付けられた）のバージョン 6 に攻撃されていると判断した。
彼はマシューに向けて、「ウロボロスのバージョン 6 は 2019 年 10 月にバグ修正されて以来、暗号化を元に戻すことはできません」と書いた。そして不満で苛立ちながら「ID ランサムウエアでそう読んだはずです」と付け加えた。
マシューはがっかりしつつ、こう反論した。「さっき ID ランサムウエアを確認したのですが、違う種類だと書いてありました」。マイケル自身のウェブサイトが、このランサムウエアをヴァッシュソレナであると特定し、適切な状況下であれば復元は可能としていたのである。「同じもので名前が違うだけなのでしょうか？ それとも本当に復元できる可能性があるのでしょうか？」
マイケルがファイル名の文字やその他のポイントを調べ直すと、ヴァッシュソレナとウロボロスを間違えていたことがわかった。この間違いは理解できるものだ。この 2 つのランサムウエアの背後にはイランのハッカーがいると考えられており、ほぼ同じ方法でファイルを暗号化しているのである。
マイケルは時間を無駄にせず、すぐ作業に取り掛かった。ヴァッシュソレナの脆弱性は、犯人が行った手抜きから生まれていた。身代金を支払った人と支払わなかった人を追跡するために、ヴァッシュソレナが身代金を請求するメッセージには、それぞれの被害者に固有の ID 番号が割り当てられていた。これはランサムウエアの標準的な手法である。
また身代金を支払った被害者には、その見返りとして、暗号化されたファイルを復元するための固有のキーが与えられるのだが、これも標準的な手法だ。しかし標準的でなかったのは、ID とキーが連動していた点だった。それがマイケルに付け入る隙を与えた。
彼はランサムウエアをリバースエンジニアリング［解析して仕組みを明らかにすること］し、このランサムウエアが ID 番号を「導出キー」と名づけられた関数に入力していることを発見した。この関数はハッカー自身が作成したと思われ、公開されていなかったが、マイケルは逆コンパイラと呼ばれるプログラミングツールを利用して、その関数を抽出することができた。
次に彼は、マシューから提供された身代金要求書に掲載されていた ID 番号を、その関数に入力してみた。そしていくつかの計算を行った結果、マイケルはファイルを復元するためのキーを生成することに成功した。その後彼は、デクリプター（復号器、被害者がデータを復元するためのコンピュータプログラム）を作成した。
2020 年 7 月、マイケルはヴァッシュソレナの最初のバージョンをクラックしていた。しかし彼は、よくそうするように、そのことを黙っていた。攻撃者がクラックを知れば、クラックの手がかりとなった欠陥を修正してしまう可能性があるからである。ハッカーの暗号技術を高めることは、ランサムウエア追跡チームが最も避けたいことだった。
マイケルは、ブリーピングコンピュータを通じて接触した少なくとも 40 人の犠牲者を救う一方で、その解決策は公にしなかった。この目立たないようにするという戦術が功を奏し、ハッカーはヴァッシュソレナを 5 回アップデートしたが、マイケルが発見した弱点が修正されることはなかった。
次に彼は、マシューに割り当てられていた ID をデクリプターにインプットし、キーの候補を 7 つ手に入れた。それらをテストしたところ、1 つがキーとして使えたため、それをマシューに送った。「再度確認しました」とマイケルはメッセージを送った。「確かにヴァッシュソレナでした。あなたのキーを手に入れることができましたよ」
マシューがそのメッセージを受け取ったのは、夜遅くなってからだった。「マイケルがやってくれた！」。彼は叫んだ。「デクリプターを手に入れた！」「そんなことができるの？ その人は誰？」とシャオがバスルームから返事を叫んだ。
マシューはマイケルの指示に従い、以前のサーバーへのアクセスを取り戻し、生徒の写真や他のファイルを復元した。「本当にすごい」と彼はマイケルに返信した。「上手くいきました。感謝してもし切れません。いったいどうやったんですか？ 先生も生徒も、あなたが助けてくれたことにとても感謝しています」
しかしマシューは、これで終わりにしなかった。彼はグーグルに対し、なぜランサムウエアの攻撃者に G メールを使うのを許可したのかと、オンラインで苦情を申し立てた。だがこの検索エンジン大手は、何の反応も示さなかった。ロンドンの学校は、わずかな予算の中でサイバーセキュリティを向上させなければならないことを認識した。マシューの勧めで、同校はバックアップ用のネットワーク接続ストレージ（NAS）を購入した。
さらに彼は、ヴァッシュソレナを使ったギャングから 1000 ユーロを取り戻すための策を練った。そしてまだキーが必要なふりをして、交渉を再開した。「私が再びあなたを信頼できるようになる唯一の方法は、私に（ビットコインを）返すことです」と彼はメールした。「そうしたら、ファイルを復元するために 3000 ユーロ払います」
しかし犯人は拒否した。「もうビットコインは売ってしまった。あなたに返す金はない」
マシューは餌を 4500 ユーロ、6000 ユーロと増やし、さらにこの一見理不尽な展開の説明を練り上げた。「思ったより多くのファイルを失ったことに気づいたんだ」
それでも犯人は返金しようとしなかった。「悪いな。この提案を 10 年間続けようが、私は拒否する」とハッカーは述べ、交渉を終わらせた。
サイバー犯罪者を出し抜くのはほとんど不可能だと、マシューは実感した――ランサムウエア追跡チームであれば話は別だが。
（訳：小林啓倫）
［日経 BOOK プラス 2023 年 9 月 6 日付の記事を転載］
